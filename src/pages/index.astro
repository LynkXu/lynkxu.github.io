---
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import HeaderLink from '../components/HeaderLink.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import FormattedDate from '../components/FormattedDate.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';

// 导入 index.md 文件
import IndexContent from '../content/index.md';

// 获取最新的博客文章（显示前10篇）
const allPosts = await getCollection('blog');
const recentPosts = allPosts
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 10);
---

<!doctype html>
<html lang="zh-CN">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<p></p>
			<div class="post-content content">
				<IndexContent />
			</div>
			
			<h3>最近文章</h3>
			<p></p>
			<ul class="posts">
				{
					recentPosts.map((post) => (
						<li>
							<span>
								<FormattedDate date={post.data.pubDate} />
							</span>
							<div>
								<a href={`/blog/${post.id}.html`}>
									{post.data.title}
								</a>
							</div>
						</li>
					))
				}
			</ul>
			<p>
				<HeaderLink href="/blog">查看全部</HeaderLink>
			</p>
		</main>
		<Footer />
	</body>
</html>
